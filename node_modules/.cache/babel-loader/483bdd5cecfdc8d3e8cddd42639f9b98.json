{"ast":null,"code":"import _concatInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/concat\";\nimport { isString } from '../lang';\nimport thenable from '../promise/thenable';\nimport { LOCALHOST_MODE } from '../constants';\nimport logFactory from '../logger';\nvar log = logFactory('', {\n  displayAllErrors: true\n});\nvar CAPITAL_LETTERS_REGEX = /[A-Z]/;\nexport function validateTrafficType(maybeTT, method) {\n  if (maybeTT == undefined) {\n    // eslint-disable-line eqeqeq\n    log.error(\"\".concat(method, \": you passed a null or undefined traffic_type_name, traffic_type_name must be a non-empty string.\"));\n  } else if (!isString(maybeTT)) {\n    log.error(\"\".concat(method, \": you passed an invalid traffic_type_name, traffic_type_name must be a non-empty string.\"));\n  } else {\n    if (maybeTT.length === 0) {\n      log.error(\"\".concat(method, \": you passed an empty traffic_type_name, traffic_type_name must be a non-empty string.\"));\n    } else {\n      if (CAPITAL_LETTERS_REGEX.test(maybeTT)) {\n        log.warn(\"\".concat(method, \": traffic_type_name should be all lowercase - converting string to lowercase.\"));\n        maybeTT = maybeTT.toLowerCase();\n      }\n\n      return maybeTT;\n    }\n  }\n\n  return false;\n}\n\nfunction logTTExistanceWarning(method, ttName) {\n  var _context;\n\n  log.warn(_concatInstanceProperty(_context = \"\".concat(method, \": Traffic Type \")).call(_context, ttName, \" does not have any corresponding Splits in this environment, make sure you're tracking your events to a valid traffic type defined in the Split console.\"));\n}\n/**\n * Separated from the previous method since on some cases it'll be async.\n */\n\n\nexport function validateTrafficTypeExistance(maybeTT, context, method) {\n  var isReady = context.get(context.constants.READY, true);\n  var settings = context.get(context.constants.SETTINGS);\n  var splitsStorage = context.get(context.constants.STORAGE).splits; // If not ready or in localhost mode, we won't run the validation\n\n  if (!isReady || settings.mode === LOCALHOST_MODE) return true;\n  var res = splitsStorage.trafficTypeExists(maybeTT);\n\n  if (thenable(res)) {\n    res.then(function (isValid) {\n      if (!isValid) logTTExistanceWarning(method, maybeTT);\n      return isValid; // propagate result\n    });\n  } else {\n    if (!res) logTTExistanceWarning(method, maybeTT);\n  }\n\n  return res;\n}","map":{"version":3,"sources":["/Users/talianassi/Desktop/todolist/node_modules/@splitsoftware/splitio/es/utils/inputValidation/trafficType.js"],"names":["_concatInstanceProperty","isString","thenable","LOCALHOST_MODE","logFactory","log","displayAllErrors","CAPITAL_LETTERS_REGEX","validateTrafficType","maybeTT","method","undefined","error","concat","length","test","warn","toLowerCase","logTTExistanceWarning","ttName","_context","call","validateTrafficTypeExistance","context","isReady","get","constants","READY","settings","SETTINGS","splitsStorage","STORAGE","splits","mode","res","trafficTypeExists","then","isValid"],"mappings":"AAAA,OAAOA,uBAAP,MAAoC,uDAApC;AACA,SAASC,QAAT,QAAyB,SAAzB;AACA,OAAOC,QAAP,MAAqB,qBAArB;AACA,SAASC,cAAT,QAA+B,cAA/B;AACA,OAAOC,UAAP,MAAuB,WAAvB;AACA,IAAIC,GAAG,GAAGD,UAAU,CAAC,EAAD,EAAK;AACvBE,EAAAA,gBAAgB,EAAE;AADK,CAAL,CAApB;AAGA,IAAIC,qBAAqB,GAAG,OAA5B;AACA,OAAO,SAASC,mBAAT,CAA6BC,OAA7B,EAAsCC,MAAtC,EAA8C;AACnD,MAAID,OAAO,IAAIE,SAAf,EAA0B;AACxB;AACAN,IAAAA,GAAG,CAACO,KAAJ,CAAU,GAAGC,MAAH,CAAUH,MAAV,EAAkB,mGAAlB,CAAV;AACD,GAHD,MAGO,IAAI,CAACT,QAAQ,CAACQ,OAAD,CAAb,EAAwB;AAC7BJ,IAAAA,GAAG,CAACO,KAAJ,CAAU,GAAGC,MAAH,CAAUH,MAAV,EAAkB,0FAAlB,CAAV;AACD,GAFM,MAEA;AACL,QAAID,OAAO,CAACK,MAAR,KAAmB,CAAvB,EAA0B;AACxBT,MAAAA,GAAG,CAACO,KAAJ,CAAU,GAAGC,MAAH,CAAUH,MAAV,EAAkB,wFAAlB,CAAV;AACD,KAFD,MAEO;AACL,UAAIH,qBAAqB,CAACQ,IAAtB,CAA2BN,OAA3B,CAAJ,EAAyC;AACvCJ,QAAAA,GAAG,CAACW,IAAJ,CAAS,GAAGH,MAAH,CAAUH,MAAV,EAAkB,+EAAlB,CAAT;AACAD,QAAAA,OAAO,GAAGA,OAAO,CAACQ,WAAR,EAAV;AACD;;AAED,aAAOR,OAAP;AACD;AACF;;AAED,SAAO,KAAP;AACD;;AAED,SAASS,qBAAT,CAA+BR,MAA/B,EAAuCS,MAAvC,EAA+C;AAC7C,MAAIC,QAAJ;;AAEAf,EAAAA,GAAG,CAACW,IAAJ,CAAShB,uBAAuB,CAACoB,QAAQ,GAAG,GAAGP,MAAH,CAAUH,MAAV,EAAkB,iBAAlB,CAAZ,CAAvB,CAAyEW,IAAzE,CAA8ED,QAA9E,EAAwFD,MAAxF,EAAgG,0JAAhG,CAAT;AACD;AACD;;;;;AAKA,OAAO,SAASG,4BAAT,CAAsCb,OAAtC,EAA+Cc,OAA/C,EAAwDb,MAAxD,EAAgE;AACrE,MAAIc,OAAO,GAAGD,OAAO,CAACE,GAAR,CAAYF,OAAO,CAACG,SAAR,CAAkBC,KAA9B,EAAqC,IAArC,CAAd;AACA,MAAIC,QAAQ,GAAGL,OAAO,CAACE,GAAR,CAAYF,OAAO,CAACG,SAAR,CAAkBG,QAA9B,CAAf;AACA,MAAIC,aAAa,GAAGP,OAAO,CAACE,GAAR,CAAYF,OAAO,CAACG,SAAR,CAAkBK,OAA9B,EAAuCC,MAA3D,CAHqE,CAGF;;AAEnE,MAAI,CAACR,OAAD,IAAYI,QAAQ,CAACK,IAAT,KAAkB9B,cAAlC,EAAkD,OAAO,IAAP;AAClD,MAAI+B,GAAG,GAAGJ,aAAa,CAACK,iBAAd,CAAgC1B,OAAhC,CAAV;;AAEA,MAAIP,QAAQ,CAACgC,GAAD,CAAZ,EAAmB;AACjBA,IAAAA,GAAG,CAACE,IAAJ,CAAS,UAAUC,OAAV,EAAmB;AAC1B,UAAI,CAACA,OAAL,EAAcnB,qBAAqB,CAACR,MAAD,EAASD,OAAT,CAArB;AACd,aAAO4B,OAAP,CAF0B,CAEV;AACjB,KAHD;AAID,GALD,MAKO;AACL,QAAI,CAACH,GAAL,EAAUhB,qBAAqB,CAACR,MAAD,EAASD,OAAT,CAArB;AACX;;AAED,SAAOyB,GAAP;AACD","sourcesContent":["import _concatInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/concat\";\nimport { isString } from '../lang';\nimport thenable from '../promise/thenable';\nimport { LOCALHOST_MODE } from '../constants';\nimport logFactory from '../logger';\nvar log = logFactory('', {\n  displayAllErrors: true\n});\nvar CAPITAL_LETTERS_REGEX = /[A-Z]/;\nexport function validateTrafficType(maybeTT, method) {\n  if (maybeTT == undefined) {\n    // eslint-disable-line eqeqeq\n    log.error(\"\".concat(method, \": you passed a null or undefined traffic_type_name, traffic_type_name must be a non-empty string.\"));\n  } else if (!isString(maybeTT)) {\n    log.error(\"\".concat(method, \": you passed an invalid traffic_type_name, traffic_type_name must be a non-empty string.\"));\n  } else {\n    if (maybeTT.length === 0) {\n      log.error(\"\".concat(method, \": you passed an empty traffic_type_name, traffic_type_name must be a non-empty string.\"));\n    } else {\n      if (CAPITAL_LETTERS_REGEX.test(maybeTT)) {\n        log.warn(\"\".concat(method, \": traffic_type_name should be all lowercase - converting string to lowercase.\"));\n        maybeTT = maybeTT.toLowerCase();\n      }\n\n      return maybeTT;\n    }\n  }\n\n  return false;\n}\n\nfunction logTTExistanceWarning(method, ttName) {\n  var _context;\n\n  log.warn(_concatInstanceProperty(_context = \"\".concat(method, \": Traffic Type \")).call(_context, ttName, \" does not have any corresponding Splits in this environment, make sure you're tracking your events to a valid traffic type defined in the Split console.\"));\n}\n/**\n * Separated from the previous method since on some cases it'll be async.\n */\n\n\nexport function validateTrafficTypeExistance(maybeTT, context, method) {\n  var isReady = context.get(context.constants.READY, true);\n  var settings = context.get(context.constants.SETTINGS);\n  var splitsStorage = context.get(context.constants.STORAGE).splits; // If not ready or in localhost mode, we won't run the validation\n\n  if (!isReady || settings.mode === LOCALHOST_MODE) return true;\n  var res = splitsStorage.trafficTypeExists(maybeTT);\n\n  if (thenable(res)) {\n    res.then(function (isValid) {\n      if (!isValid) logTTExistanceWarning(method, maybeTT);\n      return isValid; // propagate result\n    });\n  } else {\n    if (!res) logTTExistanceWarning(method, maybeTT);\n  }\n\n  return res;\n}"]},"metadata":{},"sourceType":"module"}